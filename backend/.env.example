# ===========================================
# Advancia Pay Backend - Environment Variables
# ===========================================
# Copy this file to .env and fill in your actual values

# ----- Server Configuration -----
NODE_ENV=development
PORT=4000
FRONTEND_URL=http://localhost:3000

# ----- Database -----
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/advancia_db

# PostgreSQL Connection Pool Settings (optional tuning)
PG_POOL_MAX=20
PG_POOL_MIN=5
PG_IDLE_TIMEOUT=30000
PG_CONNECTION_TIMEOUT=10000
PG_STATEMENT_TIMEOUT=30000
PG_SLOW_QUERY_THRESHOLD=1000

# ----- Azure Cosmos DB (AI/Chat Features) -----
# Optional: Used for chat history, AI context, session data
# COSMOS_DB_ENDPOINT=https://your-account.documents.azure.com:443/
# COSMOS_DB_KEY=your-cosmos-db-primary-key
# COSMOS_DB_DATABASE=advancia-ai

# ----- Azure Database for PostgreSQL (Production Alternative) -----
# Use this instead of DATABASE_URL for Azure managed PostgreSQL
# AZURE_PG_HOST=your-server.postgres.database.azure.com
# AZURE_PG_USER=admin@your-server
# AZURE_PG_PASSWORD=your-password
# AZURE_PG_DATABASE=advancia_db
# AZURE_PG_SSL=true

# ----- JWT Authentication -----
# Generate: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-min-64-chars
JWT_REFRESH_SECRET=your-refresh-secret-key-change-this-also-min-64-chars
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# ----- Enhanced Authentication -----
# Session management and token rotation
SESSION_SECRET=your-session-secret-min-32-chars-for-enhanced-auth
ACCESS_TOKEN_EXPIRY=15m
REFRESH_TOKEN_EXPIRY=7d
SESSION_CLEANUP_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90

# ----- Redis (Session & Cache) -----
REDIS_URL=redis://localhost:6379

# ----- RabbitMQ (Background Job Queue) -----
# For local development with Docker Compose
RABBITMQ_URL=amqp://advancia:rabbitmq_pass_change_in_prod@localhost:5672
# For production, use a secure password and consider managed service (CloudAMQP, AWS MQ)
# RABBITMQ_URL=amqp://username:secure_password@rabbitmq-host:5672

# ----- Email Configuration -----
# Gmail SMTP for OTP and transactional emails
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-gmail-app-password

# Resend API (for marketing emails)
RESEND_API_KEY=re_your_resend_api_key

# SendGrid (for bulk emails - optional)
SENDGRID_API_KEY=SG.your_sendgrid_api_key

# ----- Payment Gateways -----
# Stripe
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key

# Cryptomus (Crypto Payments)
CRYPTOMUS_API_KEY=your_cryptomus_api_key
CRYPTOMUS_MERCHANT_ID=your_merchant_id
CRYPTOMUS_WEBHOOK_SECRET=your_webhook_secret

# NOWPayments (Alternative Crypto Payment Provider - 200+ coins, 0.5% fees)
# Get keys from: https://nowpayments.io/dashboard
NOWPAYMENTS_API_KEY=your_nowpayments_api_key
NOWPAYMENTS_IPN_SECRET=your_nowpayments_ipn_secret
# Sandbox API key for testing: https://account.sandbox.nowpayments.io/

# Alchemy Pay (Crypto On/Off Ramp - Fiat to Crypto conversions)
# Get keys from: https://dashboard.alchemypay.org/
ALCHEMY_PAY_API_KEY=your_alchemy_pay_api_key
ALCHEMY_PAY_API_URL=https://api.alchemypay.io/v1
# Sandbox API for testing: https://sandbox-api.alchemypay.io/v1

# Alchemy Blockchain API (Seamless onchain transactions)
# Get API key from: https://www.alchemy.com/
# Supports: Ethereum, Solana, Base, Polygon, Arbitrum, Optimism + 20 more chains
ALCHEMY_API_KEY=your_alchemy_api_key

# ----- Custodial Wallet System -----
# ⚠️ CRITICAL SECURITY: Store these in a secure vault! Loss = loss of all user funds!
# Generate seed: node -e "console.log(require('bip39').generateMnemonic(256))"
WALLET_MASTER_SEED=your-24-word-bip39-mnemonic-seed-phrase-keep-this-super-secret-never-share

# Generate key: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
WALLET_ENCRYPTION_KEY=your-base64-encoded-32-byte-encryption-key-store-securely

# Admin wallet addresses for external crypto withdrawals (Coinbase, Binance, etc.)
ADMIN_BTC_WALLET_ADDRESS=your-coinbase-btc-wallet-address
ADMIN_ETH_WALLET_ADDRESS=your-coinbase-eth-wallet-address
ADMIN_USDT_WALLET_ADDRESS=your-coinbase-usdt-erc20-wallet-address

# ----- Monitoring & Logging -----
# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# OpenTelemetry (Tracing)
OTEL_SERVICE_NAME=advancia-backend
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318/v1/traces

# ----- Web Push Notifications -----
# Generate: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=your-vapid-public-key
VAPID_PRIVATE_KEY=your-vapid-private-key
VAPID_SUBJECT=mailto:your-email@example.com

# ----- Business Phone Number (SMS & WhatsApp Verification) -----
# Google Voice number for SMS verification and business communications
BUSINESS_PHONE_NUMBER=+17174695102
BUSINESS_PHONE_PROVIDER=Google Voice

# Twilio (for SMS and WhatsApp)
# Sign up: https://www.twilio.com/try-twilio (get $15 free credit)
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+17174695102

# WhatsApp Business via Twilio
# Sandbox (for testing): whatsapp:+14155238886
# Production: whatsapp:+17174695102 (after approval)
TWILIO_WHATSAPP_NUMBER=whatsapp:+14155238886

# ----- AWS S3 (for database backups) -----
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
S3_BACKUPS_BUCKET=advancia-backups

# ----- Cloudflare (Optional CDN/DNS) -----
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_ZONE_ID=your-zone-id

# ----- Cloudflare R2 (Object Storage - S3 Compatible) -----
# Bucket: advancia-backups (Created: Nov 22, 2025, Location: Eastern Europe EEUR)
CLOUDFLARE_R2_ACCOUNT_ID=74ecde4d46d4b399c7295cf599d2886b
CLOUDFLARE_R2_ACCESS_KEY_ID=your-r2-access-key
CLOUDFLARE_R2_SECRET_ACCESS_KEY=your-r2-secret-key
CLOUDFLARE_R2_BUCKET_NAME=advancia-backups
CLOUDFLARE_R2_ENDPOINT=https://74ecde4d46d4b399c7295cf599d2886b.r2.cloudflarestorage.com
# Optional: Custom domain for public access
CLOUDFLARE_R2_PUBLIC_URL=https://backups.advancia.com

# ----- Telegram Bot (Business Messaging + Trust System) -----
# Get token from @BotFather on Telegram: /newbot
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz123456789

# Get your chat ID from @userinfobot on Telegram
TELEGRAM_CHAT_ID=your-telegram-chat-id
TELEGRAM_ADMIN_CHAT_ID=123456789

# Webhook secret for secure callbacks (optional)
TELEGRAM_WEBHOOK_SECRET=your-random-secret-string-here

# ----- Rate Limiting -----
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ----- CORS Origins (comma-separated) -----
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,https://advanciapayledger.com,https://www.advanciapayledger.com,https://app.advanciapayledger.com

# ----- Price Service (CoinGecko + Binance) -----
PRICE_CACHE_TTL=300

# ----- Admin Configuration -----
ADMIN_EMAIL=admin@advancia.com
ADMIN_USERNAME=admin

# ----- Feature Flags -----
ENABLE_2FA=true
ENABLE_EMAIL_VERIFICATION=true
ENABLE_WITHDRAWAL_APPROVALS=true

# ----- Trustpilot Integration -----
# Get your API key from: https://businessapp.b2b.trustpilot.com/integrations
TRUSTPILOT_API_KEY=your_trustpilot_api_key
TRUSTPILOT_BUSINESS_UNIT_ID=your_business_unit_id
# Get Business Unit ID from: https://businessapp.b2b.trustpilot.com/account-settings
# Get Template ID from: https://businessapp.b2b.trustpilot.com/invitations/invitation-settings
TRUSTPILOT_TEMPLATE_ID=your_invitation_template_id

# ----- Scam Adviser & Trust Verification -----
SCAM_ADVISER_API_KEY=your_scam_adviser_api_key
BUSINESS_EMAIL=support@advanciapayledger.com
DOMAIN=advanciapayledger.com

# ----- RPA Automation -----
RPA_AUTO_START=true

# ----- Development Only -----
DEBUG=false
LOG_LEVEL=info
ENABLE_SWAGGER=true
