# AI Cybersecurity System Launcher\n# Comprehensive startup script for the complete AI cybersecurity monitoring system\n\nWrite-Host \"ğŸš€ AI Cybersecurity System Launcher\" -ForegroundColor Cyan\nWrite-Host \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\" -ForegroundColor Cyan\nWrite-Host \"\"\n\n# Configuration\n$projectRoot = Split-Path -Parent $PSScriptRoot\n$aiCoreDir = Join-Path $projectRoot \"ai-agent\\ai-core\"\n$dashboardDir = Join-Path $projectRoot \"ai-agent\\dashboard\"\n$monitoringDir = Join-Path $projectRoot \"ai-agent\\monitoring\"\n\n# Function to check if a port is in use\nfunction Test-Port {\n    param([int]$Port)\n    try {\n        $tcp = New-Object System.Net.Sockets.TcpListener($Port)\n        $tcp.Start()\n        $tcp.Stop()\n        return $false\n    } catch {\n        return $true\n    }\n}\n\n# Function to wait for port to be available\nfunction Wait-ForPort {\n    param([int]$Port, [string]$Service, [int]$TimeoutSeconds = 30)\n    \n    Write-Host \"â³ Waiting for $Service on port $Port...\" -ForegroundColor Yellow\n    $timeout = (Get-Date).AddSeconds($TimeoutSeconds)\n    \n    while ((Get-Date) -lt $timeout) {\n        if (Test-Port -Port $Port) {\n            Write-Host \"âœ… $Service is running on port $Port\" -ForegroundColor Green\n            return $true\n        }\n        Start-Sleep -Seconds 1\n    }\n    \n    Write-Host \"âš ï¸ Timeout waiting for $Service on port $Port\" -ForegroundColor Yellow\n    return $false\n}\n\n# Function to install dependencies if needed\nfunction Install-Dependencies {\n    param([string]$Directory, [string]$ServiceName)\n    \n    $packageJson = Join-Path $Directory \"package.json\"\n    \n    if (Test-Path $packageJson) {\n        $nodeModules = Join-Path $Directory \"node_modules\"\n        \n        if (-not (Test-Path $nodeModules)) {\n            Write-Host \"ğŸ“¦ Installing $ServiceName dependencies...\" -ForegroundColor Yellow\n            Push-Location $Directory\n            try {\n                npm install\n                if ($LASTEXITCODE -eq 0) {\n                    Write-Host \"âœ… $ServiceName dependencies installed\" -ForegroundColor Green\n                } else {\n                    Write-Host \"âŒ Failed to install $ServiceName dependencies\" -ForegroundColor Red\n                    return $false\n                }\n            } catch {\n                Write-Host \"âŒ Error installing $ServiceName dependencies: $_\" -ForegroundColor Red\n                return $false\n            } finally {\n                Pop-Location\n            }\n        } else {\n            Write-Host \"âœ… $ServiceName dependencies already installed\" -ForegroundColor Green\n        }\n    }\n    return $true\n}\n\n# Pre-flight checks\nWrite-Host \"ğŸ” Performing pre-flight checks...\" -ForegroundColor Cyan\n\n# Check Node.js\ntry {\n    $nodeVersion = node --version\n    Write-Host \"âœ… Node.js: $nodeVersion\" -ForegroundColor Green\n} catch {\n    Write-Host \"âŒ Node.js not found. Please install Node.js\" -ForegroundColor Red\n    exit 1\n}\n\n# Check npm\ntry {\n    $npmVersion = npm --version\n    Write-Host \"âœ… npm: v$npmVersion\" -ForegroundColor Green\n} catch {\n    Write-Host \"âŒ npm not found\" -ForegroundColor Red\n    exit 1\n}\n\n# Check directories\n$requiredDirs = @(\n    @{Path = $aiCoreDir; Name = \"AI Core\"},\n    @{Path = $dashboardDir; Name = \"Dashboard\"},\n    @{Path = $monitoringDir; Name = \"Monitoring\"}\n)\n\nforeach ($dir in $requiredDirs) {\n    if (Test-Path $dir.Path) {\n        Write-Host \"âœ… $($dir.Name) directory: $($dir.Path)\" -ForegroundColor Green\n    } else {\n        Write-Host \"âŒ $($dir.Name) directory not found: $($dir.Path)\" -ForegroundColor Red\n        exit 1\n    }\n}\n\n# Check for port conflicts\n$ports = @(\n    @{Port = 3002; Service = \"Dashboard\"},\n    @{Port = 8001; Service = \"Integration Server\"}\n)\n\nforeach ($portCheck in $ports) {\n    if (Test-Port -Port $portCheck.Port) {\n        Write-Host \"âš ï¸ Port $($portCheck.Port) is already in use. $($portCheck.Service) may conflict.\" -ForegroundColor Yellow\n        $response = Read-Host \"Continue anyway? (y/N)\"\n        if ($response -ne \"y\" -and $response -ne \"Y\") {\n            Write-Host \"âŒ Startup cancelled\" -ForegroundColor Red\n            exit 1\n        }\n    } else {\n        Write-Host \"âœ… Port $($portCheck.Port) available for $($portCheck.Service)\" -ForegroundColor Green\n    }\n}\n\nWrite-Host \"\"\nWrite-Host \"ğŸ› ï¸ Installing dependencies...\" -ForegroundColor Cyan\n\n# Install dependencies\n$installSuccess = $true\nif (-not (Install-Dependencies -Directory $monitoringDir -ServiceName \"Integration Server\")) {\n    $installSuccess = $false\n}\n\nif (-not (Install-Dependencies -Directory $dashboardDir -ServiceName \"Dashboard\")) {\n    $installSuccess = $false\n}\n\nif (-not $installSuccess) {\n    Write-Host \"âŒ Dependency installation failed. Please check the errors above.\" -ForegroundColor Red\n    exit 1\n}\n\nWrite-Host \"\"\nWrite-Host \"ğŸš€ Starting AI Cybersecurity System...\" -ForegroundColor Cyan\nWrite-Host \"\"\n\n# Ask user for startup mode\nWrite-Host \"Select startup mode:\" -ForegroundColor Yellow\nWrite-Host \"1. Complete System (All components + AI demonstrations)\"\nWrite-Host \"2. Monitoring Only (Dashboard + Integration Server)\"\nWrite-Host \"3. AI Agent Demo (AI components only)\"\nWrite-Host \"4. Complete Launcher (Automated all-in-one)\"\nWrite-Host \"\"\n\ndo {\n    $mode = Read-Host \"Enter choice (1-4)\"\n} while ($mode -notin @(\"1\", \"2\", \"3\", \"4\"))\n\nswitch ($mode) {\n    \"1\" {\n        Write-Host \"ğŸ¯ Starting Complete System...\" -ForegroundColor Green\n        \n        # Start Integration Server\n        Write-Host \"ğŸ“¡ Starting Integration Server...\" -ForegroundColor Cyan\n        $integrationJob = Start-Job -ScriptBlock {\n            param($dir)\n            Set-Location $dir\n            node integration_server.js\n        } -ArgumentList $monitoringDir\n        \n        Start-Sleep -Seconds 3\n        Wait-ForPort -Port 8001 -Service \"Integration Server\" -TimeoutSeconds 15\n        \n        # Start Dashboard\n        Write-Host \"ğŸ“Š Starting Dashboard...\" -ForegroundColor Cyan\n        $dashboardJob = Start-Job -ScriptBlock {\n            param($dir)\n            Set-Location $dir\n            npm start\n        } -ArgumentList $dashboardDir\n        \n        Start-Sleep -Seconds 5\n        Wait-ForPort -Port 3002 -Service \"Dashboard\" -TimeoutSeconds 30\n        \n        # Start AI Agent with demonstrations\n        Write-Host \"ğŸ¤– Starting AI Agent with demonstrations...\" -ForegroundColor Cyan\n        Push-Location $aiCoreDir\n        try {\n            node demo.js\n        } finally {\n            Pop-Location\n        }\n    }\n    \n    \"2\" {\n        Write-Host \"ğŸ¯ Starting Monitoring Components Only...\" -ForegroundColor Green\n        \n        # Start Integration Server\n        Write-Host \"ğŸ“¡ Starting Integration Server...\" -ForegroundColor Cyan\n        $integrationJob = Start-Job -ScriptBlock {\n            param($dir)\n            Set-Location $dir\n            node integration_server.js\n        } -ArgumentList $monitoringDir\n        \n        Start-Sleep -Seconds 3\n        \n        # Start Dashboard\n        Write-Host \"ğŸ“Š Starting Dashboard...\" -ForegroundColor Cyan\n        $dashboardJob = Start-Job -ScriptBlock {\n            param($dir)\n            Set-Location $dir\n            npm start\n        } -ArgumentList $dashboardDir\n        \n        Write-Host \"\"\n        Write-Host \"âœ… Monitoring system started!\" -ForegroundColor Green\n        Write-Host \"ğŸ“Š Dashboard: http://localhost:3002\" -ForegroundColor Cyan\n        Write-Host \"ğŸ“¡ Integration Server: http://localhost:8001\" -ForegroundColor Cyan\n        Write-Host \"\"\n        Write-Host \"Press any key to stop the services...\" -ForegroundColor Yellow\n        $null = $Host.UI.RawUI.ReadKey(\"NoEcho,IncludeKeyDown\")\n        \n        Stop-Job -Job $integrationJob, $dashboardJob\n        Remove-Job -Job $integrationJob, $dashboardJob\n    }\n    \n    \"3\" {\n        Write-Host \"ğŸ¯ Starting AI Agent Demo...\" -ForegroundColor Green\n        \n        Push-Location $aiCoreDir\n        try {\n            node demo.js\n        } finally {\n            Pop-Location\n        }\n    }\n    \n    \"4\" {\n        Write-Host \"ğŸ¯ Starting Complete Launcher...\" -ForegroundColor Green\n        \n        Push-Location $aiCoreDir\n        try {\n            node launcher.js\n        } finally {\n            Pop-Location\n        }\n    }\n}\n\nWrite-Host \"\"\nWrite-Host \"ğŸ‰ AI Cybersecurity System Startup Complete!\" -ForegroundColor Green\nWrite-Host \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\" -ForegroundColor Green\nWrite-Host \"\"\nWrite-Host \"Week 5: AI Core System - SUCCESSFULLY IMPLEMENTED! ğŸš€\" -ForegroundColor Cyan\nWrite-Host \"\"\nWrite-Host \"System Components:\" -ForegroundColor Yellow\nWrite-Host \"ğŸ¤– CyberAIAgent - Main AI orchestrator with threat analysis coordination\"\nWrite-Host \"ğŸ” ThreatAnalysisEngine - Pattern matching, behavioral analysis, anomaly detection\"\nWrite-Host \"ğŸ§  DecisionEngine - Intelligent automated response and risk assessment\"\nWrite-Host \"ğŸ“š LearningEngine - Machine learning capabilities and continuous improvement\"\nWrite-Host \"ğŸ¯ MLModels - Neural network simulation and threat classification\"\nWrite-Host \"ğŸ“– KnowledgeBase - Comprehensive threat intelligence and IOC database\"\nWrite-Host \"ğŸ”— DashboardConnector - Real-time integration with monitoring interface\"\nWrite-Host \"\"\nWrite-Host \"Ready for cybersecurity threat detection and automated response! ğŸ›¡ï¸\" -ForegroundColor Green\nWrite-Host \"\"\n\n# Keep console open\nRead-Host \"Press Enter to exit\"
